---
- name: Using Ansible to install Datadog Agent on EC2
  hosts: localhost
  connection: local
  become: true
  become_user: root

  tasks:
    - name: Import the Datadog Agent role from the Datadog collection
      import_role:
        name: datadog.dd.agent
  
  vars:
    datadog_api_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31356431363037666166353635306135316366653239303962313931373762656137323464346537
          3335643665383064643637623334383166333135616236360a376633623261303033323261616534
          30306364323864616639396638303334386364336539333637633938343561323234613666643232
          3136323238643634310a353362336130343330633739626462633831653738613964626631646366
          62353234633362333030323365613135396162373064343136666232356339613733363634306332
          3232663332333064363037323738323735383333363164633966
    datadog_site: "us5.datadoghq.com"
    datadog_apm_instrumentation_enabled: "all"
    key_name: web-dev-key

